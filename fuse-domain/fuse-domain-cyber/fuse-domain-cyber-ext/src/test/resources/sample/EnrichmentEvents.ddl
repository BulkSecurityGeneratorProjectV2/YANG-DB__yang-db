-- auto-generated definition
create table EnrichmentEvents
(
    network_id                    varchar(64),
    source_type                   varchar(64),
    session_id                    int,
    customer_id                   int                                                      not null,
    source_id                     numeric(39)                                              not null,
    event_id                      int                                                      not null         primary key,
    event_type_id                 int                                                      not null,
    event_severity                int,
    event_detected_time           timestamp                                                not null,
    behavior_entity_side          varchar(32),
    behavior_entity_uid           int,
    behavior_entity_md5           varchar(50),
    behavior_entity_name          varchar(256),
    behavior_entity_type          int,
    behavior_entity_linked_uid    int,
    behavior_entity_file_type     int,
    linked_entity_uid             int,
    linked_entity_md5             varchar(50),
    linked_entity_name            varchar(256),
    linked_entity_type            int,
    linked_entity_linked_uid      int,
    linked_entity_file_type       int,
    is_enrichment_rel             boolean                                                  not null,
    is_insight                    boolean                                                  not null,
    is_md5_linked_null            int,
    is_md5_behavior_null          int,
    md5_behavior_hash             int,
    md5_linked_hash               int,
    by_uid                        int,
    by_name                       varchar(256),
    by_type_id                    int,
    by_linked_entity_uid          int,
    by_file_type                  int,
    by_file_md5                   varchar(50),
    to_uid                        int,
    to_name                       varchar(256),
    to_type_id                    int,
    to_linked_entity_uid          int,
    to_file_type                  int,
    to_file_md5                   varchar(50),
    by_sid                        varchar(256),
    by_file_directory             varchar(1024),
    by_process_pid                int,
    by_process_directory          varchar(1024),
    by_file_alternate_file_stream varchar(50),
    to_registry_key               varchar(16383),
    to_registry_value_type        int,
    to_registry_permissions       varchar(50),
    to_registry_data              varchar(4096),
    to_file_directory             varchar(1024),
    to_file_alternate_file_stream varchar(50),
    to_process_pid                int,
    to_process_directory          varchar(1024),
    to_endpoint_ip                int,
    to_endpoint_remoteip          int,
    to_endpoint_remotePort        int,
    to_endpoint_port              int,
    data_remote_ip                int,
    insert_time                   timestamp ,
    stage_id                      int,
    rel_id                        int       default nextval('APD.seq_EnrichmentEventsIds') not null,

    CONSTRAINT fk_events_behaviors FOREIGN KEY (behavior_entity_uid) REFERENCES Behaviors( behavior_id),
    CONSTRAINT fk_events_behaviors_type FOREIGN KEY (behavior_entity_type) REFERENCES lov_BehaviorsTypes( type_id),
    CONSTRAINT fk_events_entities FOREIGN KEY (linked_entity_uid) REFERENCES Entities(uid),
    CONSTRAINT fk_events_type FOREIGN KEY (event_type_id) REFERENCES lov_EventsTypes(type_id),
    CONSTRAINT fk_events_by_type_obj FOREIGN KEY (by_type_id) REFERENCES lov_CyberObjectTypes(type_id),
    CONSTRAINT fk_events_to_type_obj FOREIGN KEY (to_type_id) REFERENCES lov_CyberObjectTypes(type_id)


);

